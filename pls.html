<!DOCTYPE html>
<style>
h1{
   font-size: 7vw;
   position: absolute;
   top: 40%;
   left: 50%;
   transform: translate(-50%, -50%);
}
</style>
<html>
<body onload="getLocation()" id='demo'>
<script>
    
var x = document.getElementById("demo");

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}

function showPosition(position) {
    let result
    mi_url = `https://services3.arcgis.com/Jdnp1TjADvSDxMAX/ArcGIS/rest/services/open_PresettlementVegetation/FeatureServer/0//query?geometry=${position.coords.longitude}%2C${position.coords.latitude}&geometryType=esriGeometryPoint&inSR=4326&spatialRel=esriSpatialRelIntersects&units=esriSRUnit_StatuteMile&outFields=COVERTYPE%2COBJECTID%2CAREA_MI&returnGeometry=false&returnCentroid=true&outSR=4326&f=pjson`
    fetch(mi_url + '&distance=0.0').then(response => response.json()).then(function(json) {
      local_vegetation = json.features[0]
      fetch(mi_url + `&distance=1.0&where=OBJECTID+<>+${local_vegetation.attributes.OBJECTID}`).then(response => response.json()).then(function(json) {
        nearby_vegetation = json.features

        x.innerHTML = `<h1>${local_vegetation.attributes.COVERTYPE}</h1><br />${position.coords.longitude}`
        for (feature of nearby_vegetation) {
          x.innerHTML += `<br />${feature.attributes.COVERTYPE}`
        }
      })
    })
}
</script>

</body>
</html>